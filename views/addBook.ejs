<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Add new book</title>
	</head>
	<body>
		<h1>Add a new book!</h1>
		<form action="/books/new" method="post">
			<input
				type="text"
				name="title"
				id="title"
				placeholder="Title:"
				required
			/>
			<!-- Authors select input -->
			<select name="authorId" id="authors">
				<% if (authors) { %> <% authors.forEach((author) => { %>
				<option value="<%= author.id %>"><%= author.name %></option>
				<% }); %> <% } else { %>
				<option value="">No authors found.</option>
				<% }; %>
			</select>

			<!-- Genres select input -->
			<select name="genreId" id="genres">
				<% if (genres) { %> <% genres.forEach((genre) => { %>
				<option value="<%= genre.id %>"><%= genre.name %></option>
				<% }); %> <% } else { %>
				<option value="">No genres found.</option>
				<% }; %>
			</select>

			<!-- Publication year input -->
			<input
				type="number"
				name="publication_year"
				id="publication_year"
				placeholder="Year: (1985)"
			/>
			<button type="submit">Add book</button>
		</form>
		<hr />
		<% if (!authors || authors.length === 0) { %>
		<a href="/">Add new author</a>

		<% } %> <% if (!genres || genres.length === 0) { %>
		<a href="/">Add new genre</a>
		<% } %>

		<script>
			const authorSelect = document.getElementById("authors");
			authorSelect.addEventListener("change", function () {
				if (this.value === "new_author") {
					window.location.href = "/";
				}
			});
		</script>
	</body>
</html>
